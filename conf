#!/system/bin/sh

# Define temporary working directory an
d payload-related paths
TRICKY_DIR="/data/adb/tricky_stor
e"
TMP_REMOTE="$TRICKY_DIR/remote_keybox.tmp"
KEYBOX_BASE
64_PAYLOAD="PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmL
TgiPz4KPCEtLUZldGNoIGV0Y2hlZCBmcm9tIG1vZHVsZSBZdXJpa2V5IE
1hbmFnZXItLT4KPEFuZHJvaWRBdHRlc3RhdGlvbj4KPE51bWJlck9mS2V
5Ym94ZXM+MTwvTnVtYmVyT2ZLZXlib3hlcz4KPEtleWJveCBEZXZpY2VJ
RD0iRnJlZSBrZXlib3guIEpvaW4gbXkgZ3JvdXA6IHQubWUveXVyaWlyb
290Ij4KPCEtLWh0dHBzOi8vdC5tZS95dXJpaXJvb3QtLT4KPEtleSBhbG
dvcml0aG09ImVjZHNhIj4KPFByaXZhdGVLZXkgZm9ybWF0PSJwZW0iPgo
tLS0tLUJFR0lOIEVDIFBSSVZBVEUgS0VZLS0tLS0KPCEtLWh0dHBzOi8v
dC5tZS95dXJpaXJvb3QtLT4KTUhjQ0FRRUVJT1d6NTNpdXQrWVhoZzU0R
mwwdjdpcWZ4QUU2TVhtSndnVFFlTE5aWnhIWW9Bb0dDQ3FHU000OQpBd0
VIb1VRRFFnQUU2aFBzbWtkbW9yU1llMkxNZE9xNGJOak9pWjBxRndCb0N
UMlJoNFdCbnBSOG1ZUXRrQkJnCjE4ZkU3OUZXdnMvemhjbnN2OVUzNjhh
eEdQUSt1RExkWWc9PQotLS0tLUVORCBFQyBQUklWQVRFIEtFWS0tLS0tC
jwvUHJpdmF0ZUtleT4KPENlcnRpZmljYXRlQ2hhaW4+CjxOdW1iZXJPZk
NlcnRpZmljYXRlcz4zPC9OdW1iZXJPZkNlcnRpZmljYXRlcz4KPENlcnR
pZmljYXRlIGZvcm1hdD0icGVtIj4KLS0tLS1CRUdJTiBDRVJUSUZJQ0FU
RS0tLS0tCjwhLS1odHRwczovL3QubWUveXVyaWlyb290LS0+Ck1JSUI4e
kNDQVhxZ0F3SUJBZ0lSQVB5S3hKQ016d2R3MGdUQWhLTDlKMWt3Q2dZSU
tvWkl6ajBFQXdJd09URU0KTUFvR0ExVUVEQXdEVkVWRk1Ta3dKd1lEVlF
RRkV5QTFNVEl6WTJSbE5UQXdZMlU1TVRsaVlUZGpNekZqWkRabApZVE0y
TUdNNVpUQWVGdzB5TWpBNU1UY3hOekl5TlRCYUZ3MHpNakE1TVRReE56S
XlOVEJhTURreEREQUtCZ05WCkJBd01BMVJGUlRFcE1DY0dBMVVFQlJNZ0
9HVXlPR0ZtTXpVeU16azVaVGRqT0RoaE5ERTFZMlZqT0RFNU5XRTAKTmp
jd1dUQVRCZ2NxaGtqT1BRSUJCZ2dxaGtqT1BRTUJCd05DQUFUcUUreWFS
MmFpdEpoN1lzeDA2cmhzMk02SgpuU29YQUdnSlBaR0hoWUdlbEh5WmhDM
lFFR0RYeDhUdjBWYSt6L09GeWV5LzFUZnJ4ckVZOUQ2NE10MWlvMk13Cl
lUQWRCZ05WSFE0RUZnUVV5c1NsZldJZ3Y4Ym1jU2ZXckRPcXBXaTdZeEV
3SHdZRFZSMGpCQmd3Rm9BVTAvMGQKSklzaFhpTUNkTGNHZkk1K2czSDJu
M3N3RHdZRFZSMFRBUUgvQkFVd0F3RUIvekFPQmdOVkhROEJBZjhFQkFNQ
wpBZ1F3Q2dZSUtvWkl6ajBFQXdJRFp3QXdaQUl3Q09ubE9aTkVWcHNxcS
9sWHBGakVGaG5ORlFZdlozYmdzYWd1CmN0b0NrMnV2WVdHUk1KR3RHdzF
KQWEzNVRGS09BakJPNUVhcFdpSWtZZnVSV1hKR3AzekhzaFNrTnlld1hp
NzgKcVBNNldvZTB4ZGlJV00wR1lBdUhyT01VMkRvVEVrTT0KLS0tLS1FT
kQgQ0VSVElGSUNBVEUtLS0tLQo8L0NlcnRpZmljYXRlPgo8Q2VydGlmaW
NhdGUgZm9ybWF0PSJwZW0iPgotLS0tLUJFR0lOIENFUlRJRklDQVRFLS0
tLS0KPCEtLWh0dHBzOi8vdC5tZS95dXJpaXJvb3QtLT4KTUlJRGxEQ0NB
WHlnQXdJQkFnSVJBTUNYTGtVeWxDanZGMXBMbklTeUtSSXdEUVlKS29aS
Wh2Y05BUUVMQlFBdwpHekVaTUJjR0ExVUVCUk1RWmpreU1EQTVaVGcxTT
JJMllqQTBOVEFlRncweU1qQTVNVGN4TnpJd01EQmFGdzB6Ck1qQTVNVFF
4TnpJd01EQmFNRGt4RERBS0JnTlZCQXdNQTFSRlJURXBNQ2NHQTFVRUJS
TWdOVEV5TTJOa1pUVXcKTUdObE9URTVZbUUzWXpNeFkyUTJaV0V6TmpCa
k9XVXdkakFRQmdjcWhrak9QUUlCQmdVcmdRUUFJZ05pQUFTVwozRFpsOE
lQSVAxRGdHeGYvYXhPZUZ1Z0UzWFEzRmtORGw0SzlDSXl0YytwNVk1dmF
GaDNRU25rald2K1p6bnB5CnZaRVhwMDR3TmMwaEsraFJNQmVLbWRtMGVt
SnRFalBqdkdHRVZEajlCcmFSVGl1V2hNcXRtRll0NnphMUJ5YWoKWXpCa
E1CMEdBMVVkRGdRV0JCVFQvUjBraXlGZUl3SjB0d1o4am42RGNmYWZlek
FmQmdOVkhTTUVHREFXZ0JRMgpZZUVBZklnRkNWR0xSR3hIL3hwTXllcFB
FakFQQmdOVkhSTUJBZjhFQlRBREFRSC9NQTRHQTFVZER3RUIvd1FFCkF3
SUNCREFOQmdrcWhraUc5dzBCQVFzRkFBT0NBZ0VBR0pJSWtld1ROaGxzN
kJMeVltclF4TW9iQ1k2Yy85Q1AKNHQvVnU0Ukd3VjNqWW9XOWJDQ201NE
RLRWRaYnlKOHBMZ2kxbDNpL1lhQk1Ra2NtUWI5cTUvbnNieldhd0VIawp
iTUEzb2ZkK3ZZTDdBbkE1eldvYlAxRzFlbGp0L0tYZTZHMU5sbHplVENP
b0VtdzZBQVJzQjd0U1NlT0ZvVVU1ClNBbXdUQi9UUW9oRHB4WTc2Y3Nud
0RJczd6elNRYktVbmJ1dk4rZFk3bWF4UDJxdS83WTI3VkJONGp2bjVUcE
QKM3VwSHpWNHB2LzhqQjBDemlOYzRFSXhhUXNuSStnWlNrbytUZXRaQld
peFhYYjBoaTN4Nml6djdPcTdLZ1A3cApHTVRIT3Exb05HVCtoTTJNa3VW
ajliV1dkK2dzRlVFSHRrLzRsbm1BNjhLajFIaVh6b295VWlEdEFVcVBwd
0NLCkVCL2VRTlltZzg4dzA1TkN6Y1pvYTJqamdKeElQdnMwYnh2UEh0L1
hNMUU1N3dXNGZPNEc1UFYwT2hDN2FhUFkKUVFTaHUwWHZ6R2M5SHVmdDV
6T1RWT1grcTRIRkR2UVNWQW52c0VtZGd2aXROc0xFMC9ScHJYSUlrZlpV
UkNveApCWWh1Y0xvM3hmVVpxZTlFUWFvdm1paURqTTZkc0FXZzN1a2hWV
i90VEorRmh0WDk1bS85NlFXcVJEZ25CR2lFCmkzN0RibXA3YnhxdVFuWG
FNRllKWC9mTGxrVXMrdi9kbjRTcUtBQWljcGFMTUVDQnRTSU5kbGV4c0d
lUHBsS3oKb2E5MnpjRkxoT2hySE1CY0h6eGhkcmF3N01lTzdST0tER3l5
VjQxT2o1U0d6eWJmaDdjNU1kTVlMY3h6N2Fzego3VUNLSmNqSXdUQT0KL
S0tLS1FTkQgQ0VSVElGSUNBVEUtLS0tLQo8L0NlcnRpZmljYXRlPgo8Q2
VydGlmaWNhdGUgZm9ybWF0PSJwZW0iPgotLS0tLUJFR0lOIENFUlRJRkl
DQVRFLS0tLS0KPCEtLWh0dHBzOi8vdC5tZS95dXJpaXJvb3QtLT4KTUlJ
RkhEQ0NBd1NnQXdJQkFnSUpBUEhCY3FhWjZ2VWRNQTBHQ1NxR1NJYjNEU
UVCQ3dVQU1Cc3hHVEFYQmdOVgpCQVVURUdZNU1qQXdPV1U0TlROaU5tSX
dORFV3SGhjTk1qSXdNekl3TVRnd056UTRXaGNOTkRJd016RTFNVGd3Ck5
6UTRXakFiTVJrd0Z3WURWUVFGRXhCbU9USXdNRGxsT0RVellqWmlNRFEx
TUlJQ0lqQU5CZ2txaGtpRzl3MEIKQVFFRkFBT0NBZzhBTUlJQ0NnS0NBZ
0VBcjdiSGdpdXhwd0hzSzdRdWk4eFVGbU9yNzVndk1zZC9kVEVEREpkUw
pTeHRmNkFuN3h5cXBSUjkwUEwyYWJ4TTFkRXFsWG5mMnRxdzFOZTRYd2w
1amxSZmRuSkxtTjBwVHkvNGxqNC83CnR2MFNrM2lpS2t5cG5FVXRSNldm
TWdIMFFaZktITTErZGkreTlURlJ0djZ5Ly8wcmIrVCtXOGE5bnNOTC9nZ
2oKbmFyODY0NjFxTzByT3MyY1hqcDNrT0cxRkVKNU1WbUZtQkd0bnJLcG
E3M1hwWHlUcVJ4Qi9NMG4xbi9XOW5HcQpDNEZTWWEwNFQ2TjVSSVpHQk4
yejJNVDVJS0diRmxiQzhVclcwRHhXN0FZSW1RUWNIdEdsL20wMFFMVld1
dEhRCm9WSlluRlBsWFRjSFl2QVNMdStSaGhzYkRteE1nSkowbWNEcHZzQ
zRQanZCK1R4eXdFbGdTNzB2RTBYbUxEK08KSnR2c0JzbEhadlBCS0NPZF
QwTVMrdGdTT0lmZ2ErejFaMWc3K0RWYWdmN3F1dm1hZzhqZlBpb3lLdnh
uSy9FZwpzVFVWaTJnaHpxOHdtMjd1ZC9tSU03QVkycUVPUlI4R28zVFZC
NEh6V1FncFpydDNpNU1JbENhWTUwNEx6U1JpCmlnSEN6QVBsSHdzK1cwc
kI1TitlcjUvMnBKS25mQlNEaUNpRkFWdENMT1o3Z0xpTW0wamhPMkI2dF
VYSEkvK00KUlBqeTAyaTU5bElOTVJSZXY1NkdLdGNkOXFPLzBrVUpXZFp
UZEEyWG9TODJpeFB2WnRYUXBVcHVMMTJhYis5RQphREs4WjRSSEpZWWZD
VDNRNXZOQVhhaVdRKzhQVFdtMlFnQlIvYmt3U1djK05wVUZnTlBOOVB2U
Wk4V0VnNVVtCkFHTUNBd0VBQWFOak1HRXdIUVlEVlIwT0JCWUVGRFpoNF
FCOGlBVUpVWXRFYkVmL0dreko2azhTTUI4R0ExVWQKSXdRWU1CYUFGRFp
oNFFCOGlBVUpVWXRFYkVmL0dreko2azhTTUE4R0ExVWRFd0VCL3dRRk1B
TUJBZjh3RGdZRApWUjBQQVFIL0JBUURBZ0lFTUEwR0NTcUdTSWIzRFFFQ
kN3VUFBNElDQVFCOGNNcVRsbEhjOFUrcUNyT2xnM0g3CjE3NGxtYUNzYm
8vYkowQzE3SkVnTUxiNGt2cnFzWFpzMDFVM21CL3FBQmcvMXQ1UGQ1QU9
SSEFSczFoaHFHSUMKVy9uS01hdjU3NGY5clpONFBDMlpsdWZHWGI3c0lk
SnBHaU85Y3RSaGlMdVl1bHkxMEpjY1VaR0VIcEhTWU0yRwp0a2dZYlpiY
TZsc0NQWUFBUDgzY3lEVisxYU9rVGYxUkNwL2xNMFBLdm14WU4xMFJZc0
s2MzFqcmxlR2RjZGt4Cm9TSy8vbVNRYmdjV25tQUVacnpIb0YxLzBnc28
xSFpnSW4wWUx6VmhMU0EvaVhDWDRRVDJoM0o1ejN6bmx1S0cKMW52OE5R
ZHhlaTJESUloQVNXZnU4MDRDQTk2Y1FLVFRsYWFlMmZ3ZXFYamROMS92M
m5xT2huZ055ejEzNjFtRgptcjRYbWFLSC9JdFR3T2U3Mk5JOVpjd1MxbF
ZhQ3ZzSWtURENFWGRtOXJDTlBBWTEwaVR1bklIRlhSaCs3S1B6CmxIR2V
3Q3EvOFRPb2hCUm4wL05OZmg3dVJzbE9TWi94S2JOOXRNQnR3MzdaOGQy
dnZuWHEvWVdkc20xK0pMVncKbjZ5WUQveWFjTkpCbHdwZGRsYThlYVZNa
nNGNm5CbklnUU9mOXpLU2UwNm5TVHF2Z3dVSG9zZ09FQ1pKWjFFdQp6Yk
g0eXN3YnQwMnRLdEtFRmh4K3YrT1RnZS8wNlYrakdzcVRXTHNmck9DTkx
1QThIKyt6K3BVRU5tcHFubkhvCnZhSTQ3Z0MrVE5wa2dZR2trQlQ2Qi9t
L1UwMUJ1T0JCVHpoSWxNRVpxOXFrRFd1TTJjQTVrVzVWM0ZKVWNmSG4Kd
zFJZFlJZzJXeGc3eUhjUVplbUZRZz09Ci0tLS0tRU5EIENFUlRJRklDQV
RFLS0tLS0KPCEtLWh0dHBzOi8vdC5tZS95dXJpaXJvb3QtLT4KPC9DZXJ
0aWZpY2F0ZT4KPC9DZXJ0aWZpY2F0ZUNoYWluPgo8L0tleT4KPEtleSBh
bGdvcml0aG09InJzYSI+CjxQcml2YXRlS2V5IGZvcm1hdD0icGVtIj4KL
S0tLS1CRUdJTiBSU0EgUFJJVkFURSBLRVktLS0tLQo8IS0taHR0cHM6Ly
90Lm1lL3l1cmlpcm9vdC0tPgpNSUlHNGdJQkFBS0NBWUVBMTFUQmo5RTJ
wSGt4REkrVTc3QUpxV3YrTkFBbFc4UnQ2VHRFa0ZpQnpNVElZU0Q4CmQ5
YkFvRExUcGFvNEw1SUdZZ1BRZlYxVk5XR1l4bCtIZ2Q2N0VDYjhIdVNGa
WxRUHp6L1MxTi9tQU1uS2tLaWEKTVNFZW9GUFVnZjQ2aTFUTHlXNm9CcE
wyWGNUNVRmQnpyQmF1OFdXRkQyWWg4WjlqTFAzTm9DY0hxVjFXV2xKegp
DSFBwM05HMXpwVGtwUXVNYWNSc1JMdTBvMFlQaElEU2tEU01nT1JPTnJl
RG9qczBOSVlqNHJMa3kwQjNEcm44CjNDQXpRUUNmamlEUktoM2E1WVZVQ
k5mZy8zdzdoa3o5ZXQxMHdZelRWLytMMm95emVvRFJrUkJwTnZ0cDFVWE
oKQzRndm1YSkVLeThyRTFMU2x0VHNBVk84MzZWd2hlRkZNZTY0aXBTenl
oMU9WSmdYbXJ0RElDakl6SkJQek1OUApLTjkzZ2VrK0dRVGs5bzVYOE9Q
U0xvQUZwYmpaYkFzT2RlTjNLcUQrdGNOeFhoUWZ1R0lwV3I4OXdmcEEra
2kxCjdGR0Jrcnp1TDZ0L01xUy9iTWRTdHlFNjhoeVRVbjNnWXNkazZ1c1
d2Nk9WMVNZaC94VmJKVTh6TFBKTFRYTEgKcUVmWHJrSFhSNVZwVFN6UkF
nTUJBQUVDZ2dHQUl0NENpYnNpMGZjZHpoN2h5djRDVW9DK0pNVnhSeTdE
YldTLwpjWEFqZEhqWXlZR0I0QlhTRXg2bnpzZUZXWTZYb2Y5a0h5aWh4N
GNLS2ZVR0NDMTh0TnpiTGxWcW1qK0tYOURCCjN0NXlhK1pBK3JPU1pDb3
N2MkZUbzhqNnlkenRNcXpNWUdRanFJTmdxeElvYU5FemVyc3BsSmpCSGx
Ma3lFQkEKcjVJaVYzWlpxVDU0aWdIYStIcXNxY3JLU3o5WGVUanBIeWdW
MCtwZ1VPQmJPQ2FLS2NUT05XWDUxcWNuaU9tLwpuZEhCNG5lSno4U21BU
zdsbmJ6d0dSK1BQdmFlVTBwZHl0UVNhdFVQT1Fnc3I1aUhSakNxcG5ISW
VRRXhYMldICmdBKzJGSEJ1TzdWeTlidkZSRlZNdkxxMHFSNEVxUUpBb2J
hSlJZZkxSb1BNVTY2dzVya29tOGE3V0M0dXVyRXcKLzVHZ1dPR2c3VE5X
elYrOGhqUmJaMGl3dEVwYXdEaWF2WW5naGpWeUdRcXp2bHBRbjdGNG12N
nZaZy9nd3Z4egovSmVMRGRvbDhuYkRtZTBEY1RrV25PY2h5K2xYNGtkWU
x6RGFXSXNoUXB5S0ptTWpid05EUkFxa3ZPZUpUNTQxCk9UaWIvbXpLUUV
ZaXhDWmhETWZsajNIRXd2Z0JBb0hCQU94RXJiSDg1TWRlVlpkQVlqendF
NVo4QVhsRitzZ0YKdk1ncUJOR2tpQlk5S2YwS2lUSkdtcDk1R3RSdEJtc
jQyK1B1aHlSTERvQTN0YWFQWTdKVWF5SC9iM3hlL1N2TQpMcFhTMUJ2V2
ZQNGJUNEtOa1JFVEFJU1RvMXhhNExXSXBLNnpvNTdvZzJadkZxQS81TDZ
SUld6TW1XNjlKNVZ5Ckc3TGtRQmZFUVFCdHJVQTlLZXo3RHlnUWVmeDR2
SXM5K2t4cDYreUZWY3dCTEg2RzMvdlFVQ0EwNUpLSFBhd2QKR2g2UE5CT
nhtcEtWOEFYV1lLc3RCUStlT0UrNWlyUkVJUUtCd1FEcFVITGMvWmpDZ0
tpMHIwRTMwWjNNTm9kbAp6b2c1WDlOMlA5eFhhMWhrT3BEK1FnbEFvZWh
ZWVNnaHk5c0pYRHlWbDRTMUd2RnZVeFA2UTZDcXFibzRZZktsCmtjSDgy
c3YwQmZmc25mTXArNUZBdno5SUxYNFZWeHdNWGNsRnJUems1TCtLWGNGY
VFsTE5haXJBaU81dnR3M1gKbHlwTytJRFErREhNNGVoRCt4Rnh3T2dpRD
VaQ09zbU1zLzkzOG1jTnFkeStPNDUyakVHN2FXejhCS1NkQVRhNgpiZDB
MVHUrVXNPRWdBWThyZURvb0RFTTdCdEhGZ094R3Rnbm4wckVDZ2NBMElG
YmVEUGlBait4OFNVVWpRcWhmCnJBNDdMbGhNNXc4bWJqYlA5ZWZjV0RRN
lVxZkFRdGw4VTZDNnV5OE9UTWRldTFKdmpHdXZtQnJvbTN3WWJRMlIKMj
ZSQ0lVYmo4ZEZaVnNGYlB2QW1zK25QMk9IbmpYU3d5MDNnWTJCdVRLNWd
xTnR4aE1Ud3haT05XV3RqSy9QUQpORGVwdWV2UXlmTVlmY2t5TlNkT0sr
UnNadElvS1ovSGJCTXR3NGw5Z3ZnRkFkMStPbENhaUt2RFlvaHFLeVJ5C
lpwa0RSdmt4VHQ1alhaN1VwMXk5K0h5VEhTQUl4QTc0eWlTTVdsZ2l1Mk
VDZ2NCNTE2SjBtQmNibERjR1RQUEIKSTczRmRNQ1d3Um5RNUtNNUFMYWd
ESllYbWFJNHRlSEJHQXlQZ3dXRFNNTjFpdTYwckhFSVp5Nm9sWGs4Vys3
ZQowVTVIdlpjTE1paGRWU0hucU9wRmJtTWJqSjNaYzBhbitlSDdZUWRye
WRxZmdZM29kekUwSUN3bVo3WjRRYlpiCjMrYXMvcXJDNk5XV2NoNUxneU
gydmc4ZTJWSE4xeEVqSUlLMnlaNlIxVHBYdUlacTAwZE5MU3NENjlFei9
5V0UKSXlTWVBaY0lHdkd4d3lKSXcycDkzWEtZSCt3M0Y5aFFUZ3BrbXlS
STlTNE5HN0VDZ2NCeGg2d0I1VkpjclVxegpXaU9uS1FaSm1GeVFhMFhOT
jBKZVBaZGJlZUZEMmVMNkhQRHdyL203NWdxT2dIZHM5VzJrYW5YQTJYak
5RbklSCm1LaWp6Y3REeWZieTdlUDdjMGxueUl5RzN5OVRVRkU4a0hIejh
NbVBtL0NFeTV4MEFjYm43em0zWGZJaC8vNlUKMlQ1cmthVldWWmtCdGNZ
djZ2bUQ4ZVlad1JpTzdxMHBKMExyNzU0ZjlQeEluUzZ5alZyZkhHZWZIN
1RuZ0Y0cgpkN2RpYjNEWEJ4cC9QaGpQREJlMDV1SnJkVjZ1a0JtTkpGS0
5qNUJGTVVKSzFIRXVUSW89Ci0tLS0tRU5EIFJTQSBQUklWQVRFIEtFWS0
tLS0tCjwhLS1odHRwczovL3QubWUveXVyaWlyb290LS0+CjwvUHJpdmF0
ZUtleT4KPENlcnRpZmljYXRlQ2hhaW4+CjxOdW1iZXJPZkNlcnRpZmljY
XRlcz4zPC9OdW1iZXJPZkNlcnRpZmljYXRlcz4KPENlcnRpZmljYXRlIG
Zvcm1hdD0icGVtIj4KLS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1
JSUU0RENDQXNpZ0F3SUJBZ0lSQVBYb3hYdGJtdUNRRUlybG9laDU5VGN3
RFFZSktvWklodmNOQVFFTEJRQXcKT1RFTU1Bb0dBMVVFREF3RFZFVkZNU
2t3SndZRFZRUUZFeUExTVRJelkyUmxOVEF3WTJVNU1UbGlZVGRqTXpGag
paRFpsWVRNMk1HTTVaVEFlRncweU1qQTVNVGN4TnpJeU5UQmFGdzB6TWp
BNU1UUXhOekl5TlRCYU1Ea3hEREFLCkJnTlZCQXdNQTFSRlJURXBNQ2NH
QTFVRUJSTWdPR1V5T0dGbU16VXlNems1WlRkak9EaGhOREUxWTJWak9ER
TUKTldFME5qY3dnZ0dpTUEwR0NTcUdTSWIzRFFFQkFRVUFBNElCandBd2
dnR0tBb0lCZ1FEWFZNR1AwVGFrZVRFTQpqNVR2c0FtcGEvNDBBQ1ZieEc
zcE8wU1FXSUhNeE1oaElQeDMxc0NnTXRPbHFqZ3ZrZ1ppQTlCOVhWVTFZ
WmpHClg0ZUIzcnNRSnZ3ZTVJV0tWQS9QUDlMVTMrWUF5Y3FRcUpveElSN
mdVOVNCL2pxTFZNdkpicWdHa3ZaZHhQbE4KOEhPc0ZxN3haWVVQWmlIeG
4yTXMvYzJnSndlcFhWWmFVbk1JYytuYzBiWE9sT1NsQzR4cHhHeEV1N1N
qUmcrRQpnTktRTkl5QTVFNDJ0NE9pT3pRMGhpUGlzdVRMUUhjT3VmemNJ
RE5CQUorT0lORXFIZHJsaFZRRTErRC9mRHVHClRQMTYzWFRCak5OWC80d
mFqTE42Z05HUkVHazIrMm5WUmNrTGlDK1pja1FyTHlzVFV0S1cxT3dCVT
d6ZnBYQ0YKNFVVeDdyaUtsTFBLSFU1VW1CZWF1ME1nS01qTWtFL013MDh
vMzNlQjZUNFpCT1QyamxmdzQ5SXVnQVdsdU5scwpDdzUxNDNjcW9QNjF3
M0ZlRkIrNFlpbGF2ejNCK2tENlNMWHNVWUdTdk80dnEzOHlwTDlzeDFLM
0lUcnlISk5TCmZlQml4MlRxNnhhL281WFZKaUgvRlZzbFR6TXM4a3ROY3
Nlb1I5ZXVRZGRIbFdsTkxORUNBd0VBQWFOak1HRXcKSFFZRFZSME9CQll
FRkJaTndnM3I2Kzd1eXRkbGxCRlJZWjU1R3N4M01COEdBMVVkSXdRWU1C
YUFGT1lITU5hNQpBeFJ6V2ZILzBzaGI3RUJ0ck0rb01BOEdBMVVkRXdFQ
i93UUZNQU1CQWY4d0RnWURWUjBQQVFIL0JBUURBZ0lFCk1BMEdDU3FHU0
liM0RRRUJDd1VBQTRJQ0FRQk95ODJLWUJZU1JpWFBHTFRKNVlVcElnbjB
FZDlGNHQvQ0lyZGQKdmQ5ODMxakV6bXNNUG5UdDdoZTZocGdsTTVQUElR
S0d0UzRZbE5VRTVEOVFTU0xYTWdVNFh6TzdiMHVITzNTKwoxZ0JUU0ZtK
3FXVzFuTGJpNEZnYUJYRENacCt0STBUSW0vMFNYdGEyQ0VNS3hxaDBMbU
EvOGU0ZWdja1ZXNTFZCnkxSUZXODQ5bW9JbVE3V3lqMEJzT2thbk1wajR
SbE1GcjgvemNZeHp6ZlpLM3pOMWtnRWh5VGxGSThEcFAzSTgKS3Nyckh5
aXZIZ1ZTUmd6R1h6OW5BQ0VuRENxQTkyUERhUlhyZFQzMzJYT3RTU1l2c
nBLQ2dzM1RleFhYeGxOTQpPQnhmbTlwWFV4eEhuNDFPQ3RPSDBrdWdQRG
RsZzBLTjZWa3BONUFMYmdSRjcrN2R2NDdJeFg0TkxnRjJuM2FRCnN3dDh
2LzVCM3BwYURJMWNneHg4UzRtQ2NXRDF4MGU4N0dIUmNsV28wNnVaTnRP
cjF5MFFjL1JUTHdrWmdjOWwKUmg2MFF1N0sxbkdWb0lkeDRDOW11UzEwe
lFEeWErbUgvMVpLYXFld1pUNkVvVk5SR0RKbWVRT21jdWU2NUNNYQpRY1
BRcFFlRHR5bUpHUlcxQ29PTnU1Qy8wckFWNkNEQWEwNHE0K280c0dYd2N
pb2ZYM0RKeEhhN3Avc0ZHV094CjdHWjMrR1Q4aUw2Z0V0NDZnRE95MEtq
eG10WEdkQnFBeGdEWTJzczBiNFdEeDQvcmFXUVBaVmNISnNnOFJBVWMKM
lhUMVFnUTRzZVF4S0hZOS9lNG5VcEdzSlhXclBhK1ZUMHcwK2pORWJKTz
dqVW9EWW1pVmZrYnEzZDExZE1CWgpZUkdoT1E9PQotLS0tLUVORCBDRVJ
USUZJQ0FURS0tLS0tCjwhLS1odHRwczovL3QubWUveXVyaWlyb290LS0+
CjwvQ2VydGlmaWNhdGU+CjxDZXJ0aWZpY2F0ZSBmb3JtYXQ9InBlbSI+C
i0tLS0tQkVHSU4gQ0VSVElGSUNBVEUtLS0tLQo8IS0taHR0cHM6Ly90Lm
1lL3l1cmlpcm9vdC0tPgpNSUlGUVRDQ0F5bWdBd0lCQWdJUUo4MUh5Nzh
HRngxOEsya3JTNXBaVmpBTkJna3Foa2lHOXcwQkFRc0ZBREFiCk1Sa3dG
d1lEVlFRRkV4Qm1PVEl3TURsbE9EVXpZalppTURRMU1CNFhEVEl5TURre
E56RTNNVGswTTFvWERUTXkKTURreE5ERTNNVGswTTFvd09URU1NQW9HQT
FVRURBd0RWRVZGTVNrd0p3WURWUVFGRXlBMU1USXpZMlJsTlRBdwpZMlU
1TVRsaVlUZGpNekZqWkRabFlUTTJNR001WlRDQ0FpSXdEUVlKS29aSWh2
Y05BUUVCQlFBRGdnSVBBRENDCkFnb0NnZ0lCQU4zT2wzTVF0b2JzWkNSR
3d2VmlIT2NrOUlMb21vMzl5MjNXYzBaYWEyMDRyNjlyTUNLeThvKysKbE
dESjViSW5TbmxmRk93aUhhcUxDalgzWCtMN2hwdGFnYVcwMnhQU21idGp
JRjBEKzFBa0hIMnR2Q0dOVlUrYgpYZ3BOODJhNVBQNWl2VGhqQjVKbVV2
MCtZZ0ZIRDBNTUphNGlIKytZeDhnZU0xTThVK2hZNXVHUWgwdnNLYysrC
jFwRkVzclFPcVZLUzlRK3k4eitDNk1UYytIMlpYdWFMM3dRRjliZ2RGZT
E3SDZlYmF0VDh0QzhuU1pxeW9TcEQKcUxJa3EwWlN3K3BDYXJxK3JkR1F
odHRnRjNQOXFiaWxjS0NKQzNOdVJHQnBrN2JyMjBaN3A5WWF2c2Q2SDd3
aAowb0YzdlVYZVVVRlpGNFJGTEcxM1AvTllUS1JTaGV6VnU5aENCY3k1Z
DF0cHVIR1lETnJ0ZDhPa1E4b0lnT284CkY5TE5kbUE2aVgzY0hicElTYl
ZLZ3VvRFdjUHFGaml1MHpKU05jd0wvaFdyeGhOOVdwN05tRFFjcmZ3Y1U
vbjQKb1hZOVE1MVlsSUI5eWVKUjNYLzRFTjlTaXpHc1JFb3VOSlovNmJR
UVRuL3N1V0JCV0pld3ZIb0p4ZXgvVXNlQgpRVlYvTjhWNmUzTGJ2RG55W
mowMG1rMHdCRWxaNGtKZm9OcWVEeHk2TzByMmk1dElQdzFoM0o2RnU0VG
hVWlJrCmdMazB0b3NWM2ZseTE0c2I3d3NlcW9lS1MzUG1ZamtVZFNNZ0R
ZRWovSmdlOVhualVHeWVXRFZydFhCNFFpdnYKRTU2MS8rMFZVcTdJOEgr
M1BrMkpsOWlSY2Y4Skk1UUlIUXB1d29qYVBXaXQ3UktvSWdYekFnTUJBQ
UdqWXpCaApNQjBHQTFVZERnUVdCQlRtQnpEV3VRTVVjMW54LzlMSVcreE
FiYXpQcURBZkJnTlZIU01FR0RBV2dCUTJZZUVBCmZJZ0ZDVkdMUkd4SC9
4cE15ZXBQRWpBUEJnTlZIUk1CQWY4RUJUQURBUUgvTUE0R0ExVWREd0VC
L3dRRUF3SUMKQkRBTkJna3Foa2lHOXcwQkFRc0ZBQU9DQWdFQUF6aU1MR
VdlRTVUczl1ajVIbTJLdTNocUpWazRaMC96VWlvMQplYll6SUFiTHZ6Mi
85QVJ3SHVudHBXM1psZnozdGdCOEVDYnUwSmFVZ1Z2VFJHWDlxN3lLd2U
1RlowZ3lLVW0zCnVybms0bTBaL1BVYVZ5VTAydG1ra2gvbml4QzlGV1Bh
bUlrMnd1a0Y2eHJRZG13ZjU2NENQVHZ3TXR3REhSeWgKZVppTXRRelRVM
XRpYS9sRm1aK2g0ZE5jOVBVbXM3OE1TNStPRG1qaFdjcmdHVEhrTStJbX
ZFQW9wQUFvakxSNApyREZ2MjFGK0tHclMrWWViYncxcHYvbzMzZURsR3N
TcXNFUDk2UzR3emdYcjN3Y0RYT2haWkRkSXp0MTJPc0g4ClprUnJXbkJh
RjVuYldDbHdOSDNsa3ZPb3B4a3dLUWdqOHVJd1lNckIyZitzYWtFT05QM
WhERWNUV1RLRlBJeTYKemYrVDEzNUpkMDZ6T0F0NWF4c0RaR3dXR0pXNm
RDOUprMkkrNzlnMVlkcVZyU013QVIzOW1DcGE0dVNKcDN2NgpZTmZXTXR
HMGlZWGROTHErdUpyVjcrS2I4Z05OQjZ0YUlkR3JVajJqOVNYT2twL01T
d1hyeit6MHgralcwQVJ2CmNRYmpPWXMwd3Y2Q0JUcFRoV0F0VEJpY0Vjc
i9tVDhvMVVSZ0RYUGQzaXRWT2FYUHdXVFFlNnEycXFoZjU1ZUYKbHMxOU
dwd2lBTnlOQTRwVVVLbW1Oa2k3RDR1TUZNVUhnc0JUd01oZDg1QnBOWHJ
BcHNuV3JEREg5VEF6M0xSMQpiN0dMbjBFWkdjdlRwMGlRbm13ekg3eC9F
bVZPLyt1ZlM2cGZacWxDUFI5MUJLZlBKSlgyMm1CTkxjVkdxZmZ0Ci81U
GpLUmM9Ci0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0KPC9DZXJ0aWZpY2
F0ZT4KPENlcnRpZmljYXRlIGZvcm1hdD0icGVtIj4KLS0tLS1CRUdJTiB
DRVJUSUZJQ0FURS0tLS0tCjwhLS1odHRwczovL3QubWUveXVyaWlyb290
LS0+Ck1JSUZIRENDQXdTZ0F3SUJBZ0lKQVBIQmNxYVo2dlVkTUEwR0NTc
UdTSWIzRFFFQkN3VUFNQnN4R1RBWEJnTlYKQkFVVEVHWTVNakF3T1dVNE
5UTmlObUl3TkRVd0hoY05Nakl3TXpJd01UZ3dOelE0V2hjTk5ESXdNekU
xTVRndwpOelE0V2pBYk1Sa3dGd1lEVlFRRkV4Qm1PVEl3TURsbE9EVXpZ
alppTURRMU1JSUNJakFOQmdrcWhraUc5dzBCCkFRRUZBQU9DQWc4QU1JS
UNDZ0tDQWdFQXI3YkhnaXV4cHdIc0s3UXVpOHhVRm1Pcjc1Z3ZNc2QvZF
RFRERKZFMKU3h0ZjZBbjd4eXFwUlI5MFBMMmFieE0xZEVxbFhuZjJ0cXc
xTmU0WHdsNWpsUmZkbkpMbU4wcFR5LzRsajQvNwp0djBTazNpaUtreXBu
RVV0UjZXZk1nSDBRWmZLSE0xK2RpK3k5VEZSdHY2eS8vMHJiK1QrVzhhO
W5zTkwvZ2dqCm5hcjg2NDYxcU8wck9zMmNYanAza09HMUZFSjVNVm1GbU
JHdG5yS3BhNzNYcFh5VHFSeEIvTTBuMW4vVzluR3EKQzRGU1lhMDRUNk4
1UklaR0JOMnoyTVQ1SUtHYkZsYkM4VXJXMER4VzdBWUltUVFjSHRHbC9t
MDBRTFZXdXRIUQpvVkpZbkZQbFhUY0hZdkFTTHUrUmhoc2JEbXhNZ0pKM
G1jRHB2c0M0UGp2QitUeHl3RWxnUzcwdkUwWG1MRCtPCkp0dnNCc2xIWn
ZQQktDT2RUME1TK3RnU09JZmdhK3oxWjFnNytEVmFnZjdxdXZtYWc4amZ
QaW95S3Z4bksvRWcKc1RVVmkyZ2h6cTh3bTI3dWQvbUlNN0FZMnFFT1JS
OEdvM1RWQjRIeldRZ3BacnQzaTVNSWxDYVk1MDRMelNSaQppZ0hDekFQb
Eh3cytXMHJCNU4rZXI1LzJwSktuZkJTRGlDaUZBVnRDTE9aN2dMaU1tMG
poTzJCNnRVWEhJLytNClJQankwMmk1OWxJTk1SUmV2NTZHS3RjZDlxTy8
wa1VKV2RaVGRBMlhvUzgyaXhQdlp0WFFwVXB1TDEyYWIrOUUKYURLOFo0
UkhKWVlmQ1QzUTV2TkFYYWlXUSs4UFRXbTJRZ0JSL2Jrd1NXYytOcFVGZ
05QTjlQdlFpOFdFZzVVbQpBR01DQXdFQUFhTmpNR0V3SFFZRFZSME9CQl
lFRkRaaDRRQjhpQVVKVVl0RWJFZi9Ha3pKNms4U01COEdBMVVkCkl3UVl
NQmFBRkRaaDRRQjhpQVVKVVl0RWJFZi9Ha3pKNms4U01BOEdBMVVkRXdF
Qi93UUZNQU1CQWY4d0RnWUQKVlIwUEFRSC9CQVFEQWdJRU1BMEdDU3FHU
0liM0RRRUJDd1VBQTRJQ0FRQjhjTXFUbGxIYzhVK3FDck9sZzNINwoxNz
RsbWFDc2JvL2JKMEMxN0pFZ01MYjRrdnJxc1haczAxVTNtQi9xQUJnLzF
0NVBkNUFPUkhBUnMxaGhxR0lDClcvbktNYXY1NzRmOXJaTjRQQzJabHVm
R1hiN3NJZEpwR2lPOWN0UmhpTHVZdWx5MTBKY2NVWkdFSHBIU1lNMkcKd
GtnWWJaYmE2bHNDUFlBQVA4M2N5RFYrMWFPa1RmMVJDcC9sTTBQS3ZteF
lOMTBSWXNLNjMxanJsZUdkY2RreApvU0svL21TUWJnY1dubUFFWnJ6SG9
GMS8wZ3NvMUhaZ0luMFlMelZoTFNBL2lYQ1g0UVQyaDNKNXozem5sdUtH
CjFudjhOUWR4ZWkyRElJaEFTV2Z1ODA0Q0E5NmNRS1RUbGFhZTJmd2VxW
GpkTjEvdjJucU9obmdOeXoxMzYxbUYKbXI0WG1hS0gvSXRUd09lNzJOST
laY3dTMWxWYUN2c0lrVERDRVhkbTlyQ05QQVkxMGlUdW5JSEZYUmgrN0t
QegpsSEdld0NxLzhUT29oQlJuMC9OTmZoN3VSc2xPU1oveEtiTjl0TUJ0
dzM3WjhkMnZ2blhxL1lXZHNtMStKTFZ3Cm42eVlEL3lhY05KQmx3cGRkb
GE4ZWFWTWpzRjZuQm5JZ1FPZjl6S1NlMDZuU1Rxdmd3VUhvc2dPRUNaSl
oxRXUKemJINHlzd2J0MDJ0S3RLRUZoeCt2K09UZ2UvMDZWK2pHc3FUV0x
zZnJPQ05MdUE4SCsreitwVUVObXBxbm5Ibwp2YUk0N2dDK1ROcGtnWUdr
a0JUNkIvbS9VMDFCdU9CQlR6aElsTUVacTlxa0RXdU0yY0E1a1c1VjNGS
lVjZkhuCncxSWRZSWcyV3hnN3lIY1FaZW1GUWc9PQotLS0tLUVORCBDRV
JUSUZJQ0FURS0tLS0tCjwvQ2VydGlmaWNhdGU+CjwvQ2VydGlmaWNhdGV
DaGFpbj4KPC9LZXk+CjwvS2V5Ym94Pgo8L0FuZHJvaWRBdHRlc3RhdGlv
bj4KPCEtLVRoYW5rIHlvdSB2ZXJ5IG11Y2guIEpvaW4gbXkgZ3JvdXA6I
Gh0dHBzOi8vdC5tZS95dXJpaXJvb3QtLT4="

# Expected identifi
ers for the legitimate 'Newbkey' module
REQ_ID="id=Newbke
y"
REQ_NAME="name=Newb Keybox Manager"
REQ_DESC="descript
ion=A systemless module to get strong integrity so easily
"
REQ_UPDATE="updateJson=https://raw.githubusercontent.co
m/ahnanhaquemahi/Newbkey/main/update.json"

# Warning template fo
r any fake/stolen module
# We will replace {MODULE} with 
the actual module name when patching
FAKE_WARNING_TEMPLAT
E='description={MODULE} is a code thief. Use Newb Keybox 
Manager instead.'

# Simple output function for printing 
messages to the console
ui_print() {
  echo "$1"
}

# Gen
eric function to detect and neutralize fake modules
# Tak
es a single argument: module name (e.g. "MagiskLabs", "Ak
", "Hzzmonet")
detect_and_patch_fake() {
  MODULE="$1"
  
WARNING_DESC="${FAKE_WARNING_TEMPLATE/\{MODULE\}/$MODULE}
"

  # Check both Magisk module directories for this modu
le
  for DIR in "/data/adb/modules/$MODULE" "/data/adb/mo
dules_update/$MODULE"; do
    [ -d "$DIR" ] || continue  
              # Skip if directory does not exist
    PROP
="$DIR/module.prop"
    [ -f "$PROP" ] || continue       
        # Skip if module.prop is missing

    # If id mat
ches exactly the module name, treat it as fake
    if gre
p -q "^id=$MODULE\$" "$PROP"; then
      ui_print "- Dete
cted fake module: $MODULE"

      # Place 'remove' file t
o trigger automatic removal by Magisk
      touch "$DIR/r
emove"

      # Replace the description line with our war
ning
      sed -i "s|^description=.*|$WARNING_DESC|" "$PR
OP"
      ui_print "- Patched description in $PROP"

    
  # Return failure (non-zero) to signal that decoding sho
uld be aborted
      return 1
    fi
  done

  # Return s
uccess (zero) if no fake module was found
  return 0
}

#
 Loop through each fake module name
for FAKE in "MagiskLa
bs" "Ak" "Hzzmonet"; do
  if ! detect_and_patch_fake "$FA
KE"; then
    ui_print "- Decode aborted due to presence 
of stolen module: $FAKE."
    exit 0
  fi
done

# Locate 
the legitimate 'Newbkey' module's installation path
MOD_P
ATH=""
if [ -d /data/adb/modules/Newbkey ]; then
  MOD_PA
TH="/data/adb/modules/Newbkey"
elif [ -d /data/adb/module
s_update/Newbkey ]; then
  MOD_PATH="/data/adb/modules_up
date/Newbkey"
else
  # Abort if Newbkey module is not fou
nd
  ui_print "- 'Newbkey' module not found. Skipping dec
ode process."
  exit 0
fi

# Define the path to the Yurik
ey module's module.prop file
PROP_FILE="$MOD_PATH/module.
prop"
if [ ! -f "$PROP_FILE" ]; then
  # Abort if module.
prop is missing
  ui_print "- module.prop file not found:
 $PROP_FILE"
  ui_print "- Decode process will not be per
formed."
  exit 0
fi

# Function to verify that a require
d line exists in module.prop
check_prop() {
  grep -qxF "
$1" "$PROP_FILE" || {
    ui_print "- Missing or incorrec
t line: $1"
    ui_print "- module.prop is invalid. Decod
e process will not be performed."
    exit 0
  }
}

# Val
idate that all expected Yurikey fields exist in module.pr
op
check_prop "$REQ_ID"
check_prop "$REQ_NAME"
check_prop
 "$REQ_DESC"
check_prop "$REQ_UPDATE"

# Decode the Base6
4 payload only if all checks have passed
decode_keybox() 
{
  printf '%s' "$KEYBOX_BASE64_PAYLOAD" | base64 -d > "$
TMP_REMOTE" || {
    ui_print "- Error: Base64 decode fai
led"
    return 1
  }
}

# Execute decoding process
decod
e_keybox
